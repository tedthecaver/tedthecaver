---
layout: post
title: "Kioptrix"
date: 2024-11-21
---
# ted
In this level we are told the password is stored in the readme file in the home directory. A problem arises when upon logging in with ssh we are immediately booted out...

Ok let us look at the login page. `ssh bandit18@bandit.labs.overthewire.org -p 2220`

![picture](https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Pastedimage20241105174808.png)

We are booted immediately. Maybe we can use the telnet protocol to login? Telnet doesn't provide the encryption that ssh does but the login problem might be with ssh. `telnet bandit18@bandit.labs.overthewire.org -p 2220`

![Picture](https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Pastedimage20241105174254.png) 

For the uninintiated telnet and ssh are two protocols that allow you to connect to another server over the internet or network. Telnet sends your information in plaintext meaning that your username and password are easily visible whereas ssh encrypts this information. Think of logging into a website where you enter a username and password, that usually uses a protcol called https and this works similar to ssh and telnet. 

Alright back to the problem at hand, we are using the wrong format for a telnet login but the problem lies within the bash shell so switching protocols shouldn't be the fix. Let's stick with ssh and try adding something else to the command.... how about removing the .bashrc file? This is the file that is logging us out so perhaps removing it will solve our problems? 

![Picture](https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Pastedimage20241105175949.png)

Ok that didn't work, we were denied the permission to remove the .bashrc file. Let's try to understand this specific file a bit more.

![Picture](https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/2024-11-1615_51_51.png)

It looks like .bashrc is a file that you can't remove since it allows you to interact with your terminal. Let's move on then. How about a little internet search for our problem?  

![Picture](https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Pastedimage20241105180012.png)

We might have a winner! 

![Picture](https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Pastedimage20241105180039.png)

Easy. Once we login all we have to do is cat the readme file for the password. 

_But why does this work?_

Well, when we login normally with ssh it runs the default shell that is specified in the user config. This default shell could be /bin/bash which loads the .bashrc file on login. If there is an issue in the .bashrc file we may get kicked out because the shell fails to initialize. To get around this we can use the `-t` flag which forces ssh to allocate a terminal that ensures /bin/bash runs in an interactive session and `/bin/bash` which overrides the default shell and bypasses the quirks of .bashrc. In essence `-t` gives us an interactive terminal and `/bin/bash` gives us a shell that doesn't load the corrupt .bashrc file.


# Bandit Lvl 19

In this level the password is stored in the /etc/bandit_pass directory but we lack the permissions to read it. Perhaps the setuid binary can help us... 

![Picture](https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Pastedimage20241105182638.png)

It was worth a shot.

Let's get some information on that file in the home directory.

![Picture](https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/2024-11-16.png)

Ok, not a whole lot of information to work with though it is important to note that the file is executable. Let's try and see what is actually inside this bandit20-do file.

![Picture](https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Pastedimage20241105201022.png)

Ok looks like the file is not human-readable but we have some information in there nonetheless. Let's try extracting the human-readable information. 

![Picture](https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/2024us.png)

This file let's us run a command as another user which might be exactly what we need. An example is given: `%s id`. But what does this mean? 

Let's freestyle. (remember ./ before a file allows us to execute that file ONLY if it has executable properties)

![Picture](https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Pastedimage20241105201912.png)

Ok we seem to have stumbled on the right formatting for the use of this setuid binary. `./bandit20-do <command>` runs the command with the permissions given by the bandit20-do file. Let's zero in on that last command. 

![Picture](https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/202us.png)

The euid tells us that our executable permissions are that of the user bandit20. Since each user is able to access the password for their level we should be able to use bandit20-do to cat the password for this level.

![Picture](https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/lius.png)

Voila! 
